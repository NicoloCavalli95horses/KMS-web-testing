---
ID: 2025-04-04T13:03:56.059Z
tags:
  - paper
  - projectSLR
  - prototypePollution
  - ReDoS
  - taintAnalysis
Project:
  - SLR
---
The paper assesses the presence of vulnerable JS functions in active JavaScript projects in the real world. 9+ Millions of JS functions were tested against a dataset of vulnerable JS function build from VulnCode-DB and Snyk. The authors focus on prototype pollution and ReDoS (Regular Expression Denial of Service), as vulnerable implementations patterns may be detected automatically for these issues. The core idea is that a real project that include a vulnerable library it is not necessarily vulnerable if the vulnerable function is (i) actually used in the project (ii) accessible from the user. Pattern and textual-similarity-based approaches and multi-files static taint analysis were performed to assess the prevalence of prototype pollution and ReDoS.
## Context

The study of vulnerabilities in JS dependencies has led to the flagging a number of projects as vulnerable, due to the presence of vulnerable dependencies. In reality, many such projects (73%) are not really vulnerable because they do not actually use the vulnerable functions. 

There are ==insufficient reliable dataset of vulnerable code== and therefore it is complicated to train models or to test other mitigation solution properly.

The objective of our study is to assess the presence of vulnerable JS functions in active JavaScript projects in the real world. We gather JS from 3 sources
- NPM packages
- Chrome web extensions
- top popular websites

And we test +9M of JS functions against a dataset of vulnerable JS functions we build

### Approach

**Creation of dataset of vulnerable functions**
- we automatically collect vulnerable JavaScript functions from Snyk and VulnCodeDB (vulnerability databases), to compose an updated dataset. Only entries that present a link to the source code were taken into consideration
- Test files, empty functions or cases were both vulnerable and fixed functions were identical were ruled out
- Almost 5000 functions were found (895 entries), but only [[ReDoS (Regular Expression Denial of Service)]] (121 entries), and [[prototype pollution]]  (101 entries) were considered.
- 150 entries were manually verified (using a web application developed ad hoc for that to simplify the process) and studied to identify patterns
-  new rules to detect ReDoS and prototype pollution were created on [Semgrep](https://semgrep.dev/docs/) 


**Vulnerability patterns creation**
- we create vulnerability patterns and a web-based tool for efficient manual verification of vulnerable functions. In the end, we compose an informative, semi-automatically verified dataset of 1,360 JavaScript vulnerable functions
- We develop an experimental vulnerability detection and verification framework that consists of the combination of pattern and textual-similarity-based approaches and of a [[static taint analysis]]  with a novel representation of file dependency graphs.
- [[AST (Abstract Syntax Tree)]] representation were used with a File Dependency Graph (FDG), which enables multi-file taint-tracking
- The framework includes our manually developed rule sets for vulnerable pattern detection of two common JavaScript vulnerability types: [[prototype pollution]] and [[ReDoS (Regular Expression Denial of Service)]]


**Finding new vulnerabilities in the wild**
We gather a large dataset of 9,205,654 JavaScript functions from active real-world projects from three different application types (NPM packages, Chrome extensions, and top websites). This collection process is also fully automated. We use this dataset in our evaluation framework
1. We detect 124,934 vulnerable functions from this real world dataset. The estimated average precision is 94.5%, based on manual verification of a small subset
2. We perform a case study on 17 popular/critical projects that contain 20 vulnerable functions; all these functions flagged by our framework are found to be, indeed, exploitable
3. With our taint analysis, we identify 301 cases from 134 NPM packages (5.7% of all findings in NPM packages), which are exploitable in the project context. Manual verification of 100 cases detected no false positives produced by the taint analysis mechanism
4. **Semi-automated reporting approach**: to deal with a large number of disclosure notices, we develop a semi-automated technique to report our findings. We first search for duplicates of our findings in the CVE database (and identify 19 cases) and then automatically compose readable vulnerability reports for the remaining 290 findings and send them to 112 responsible project developers
5. **25 new public CVEs and 169 reserved CVEs** were obtained
6. All the framework code and datasets is available at: https://github.com/Marynk/JavaScriptvulnerability-detection.


---
#### References
- [[(Kluban, Mannan, et al., 2024)]]
