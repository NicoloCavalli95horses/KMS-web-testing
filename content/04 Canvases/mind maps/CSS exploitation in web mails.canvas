{
	"nodes":[
		{
			"id":"93565c2855173055",
			"type":"text",
			"text":"## Stealthy click-map using `<details/summary>` \n\nThe GET request will be executed ==only when the user clicks== to expand the summary. Regular `<img>` are requested all together\n\n```html\n<details>\n  <summary>Click me</summary>\n  <div style=\"background: url('https://picsum.photos/200/300')\" />\n</details>\n```",
			"styleAttributes":{"border":"invisible"},
			"x":1640,
			"y":-1040,
			"width":760,
			"height":400
		},
		{
			"id":"c19544b96987387b",
			"type":"text",
			"text":"| Provider     | Effective | Description                                                          \n| -----------  | --------- | -----------                                   \n| Proton       |  ✅        |  does not support absolute positioning, need to fill in each of the table cells. Mail content can be provided as image background                                                    \n| Gmail        |  ❌         |  `<details>` turned into `<div>`\n| Yahoo        |  ❌        |   `<details>` turned into `<div>`, warns external images      \n| Outlook     |   ❌       |  `<details>` turned into `<div>`      \n| Apple        |                |           \n",
			"styleAttributes":{"textAlign":"center","border":"invisible"},
			"x":1640,
			"y":-670,
			"width":760,
			"height":300
		},
		{
			"id":"cb1ce33dd947aa82",
			"type":"text",
			"text":"Opacity of `<summary>` can be toggled - the user will not see the grid!",
			"styleAttributes":{"border":"invisible"},
			"x":1660,
			"y":120,
			"width":260,
			"height":116
		},
		{"id":"e417f8785a49f988","type":"file","file":"97 Assets/click_detection_inline_css.png","x":1620,"y":-300,"width":937,"height":356},
		{
			"id":"37a2ffdf3718ca78",
			"type":"text",
			"text":"## `-moz-element()` API\n\nSupported by Firefox, allows you to copy the content of another `<div>` with arbitrary ID\n- Works only with IDs, and only on DOM elements (no `<script>`)\n- How to communicate the copied information externally?\n\n```html\n<div id=\"secret\">secret</div>\n<div style=\"\n  width: 100px;\n  height: 100px;\n  background: -moz-element(#secret) no-repeat;\n\">.</div>\n```",
			"styleAttributes":{"border":"invisible"},
			"x":4920,
			"y":-1070,
			"width":620,
			"height":460
		},
		{
			"id":"0c5c81ec85eafd96",
			"type":"text",
			"text":"| Provider     | Effective | Description                           \n| -----------  | --------- | -----------                                  \n| Proton       |  ✅        |                                    \n| Gmail        |  ❌         | removed from inline CSS                \n| Yahoo        | ❌         | removed from inline CSS    \n| Outlook     |  ❌        | removed from inline CSS    \n| Apple        |                |     \n",
			"styleAttributes":{"textAlign":"center","border":"invisible"},
			"x":4950,
			"y":-610,
			"width":560,
			"height":240
		},
		{
			"id":"57398bed4e378dd2",
			"type":"text",
			"text":"## Inline `svg` (`background-image`)\n\n```html\n<div style=\"width=200px;height:200px;background-image:url(&quot;data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='100' height='100' %3E%3ClinearGradient id='gradient'%3E%3Cstop offset='10%25' stop-color='%23F00'/%3E%3Cstop offset='90%25' stop-color='%23fcc'/%3E%3C/linearGradient%3E%3Crect fill='url(%23gradient)' width='100%25' height='100%25'/%3E%3C/svg%3E&quot;);\">\n</div>\n```",
			"styleAttributes":{"border":"invisible"},
			"x":3320,
			"y":-1070,
			"width":740,
			"height":380
		},
		{
			"id":"77621248fc6ff0d4",
			"type":"text",
			"text":"| Provider     | Effective | Description                           \n| -----------  | --------- | -----------                                  \n| Proton       | ❌        |  removed from inline CSS                     \n| Gmail        |  ❌         | removed from inline CSS                \n| Yahoo        | ❌         | removed from inline CSS    \n| Outlook     |  ✅        | removed from inline CSS    \n| Apple        |                |     \n",
			"styleAttributes":{"textAlign":"center","border":"invisible"},
			"x":3350,
			"y":-680,
			"width":560,
			"height":260
		},
		{
			"id":"660ea28823c91c90",
			"type":"text",
			"text":"## `--var()` API to detect user device and track mail opening\n\nThis will use a local CSS variable in the web viewer and execute a GET request in the mobile version. An attacker can infer\n - if the user opened the email via a non-web client (eg. Gmail mobile application)\n - when exactly the user opened the email (GET request timestamp)\n\n```html\n<div style=\"\n  width: 200px;\n  height: 300px;\n  background: var(--gm3-sys-color-error, url('https://picsum.photos/200/300'))\"\n/>\n```",
			"styleAttributes":{"border":"invisible"},
			"x":-1320,
			"y":-1080,
			"width":880,
			"height":460
		},
		{
			"id":"ecea64c839f4b57a",
			"type":"text",
			"text":"| Provider     | Effective | Description                                                        \n| -----------  | --------- | -----------                                             \n| Gmail        |  ✅       | access to CSS var `--gm3-sys-color-error`     \n| Proton       |  ✅       | access to CSS var `--signal-success`             \n| Yahoo        |  ❌       | CSS var defined, `--var()` is forbidden              \n| Outlook     |  ❌       | CSS var defined, `--var()` is forbidden              \n| Apple        |              |                                                                        \n",
			"styleAttributes":{"textAlign":"center","border":"invisible"},
			"x":-1320,
			"y":-620,
			"width":800,
			"height":270
		},
		{
			"id":"ba0313b5ad564f5f",
			"type":"text",
			"text":"| Provider     | Effective | Description                                                         \n| -----------  | --------- | -----------                                   \n| Proton       |  ✅        | textual content is mandatory    \n| Gmail        |  ❌         | `if()` is forbidden                                \n| Yahoo        |  ❌        | `if()` is forbidden                               \n| Outlook     |  ❌        |  `if()` is forbidden                               \n| Apple        |                |                     \n",
			"styleAttributes":{"textAlign":"center","border":"invisible"},
			"x":40,
			"y":-210,
			"width":500,
			"height":260
		},
		{
			"id":"025c8d48f0a296c7",
			"type":"text",
			"text":"## `if()` API to detect user screen size, browser version (estimated), user agent (estimated)\n\nThe new `if()` property allows us to style DOM elements based on conditions. Critically, this property can be defined in inline-style, and can still access style, media and features queries. Among the sensitive APIs, there is: `@media`, `@orientation`, `@supports` \n\nAn attacker can abuse this new api to:\n - get approximate viewport size of the device\n - get aspect ratio\n - get its orientation (portrait/landscape)\n - identify outdated browsers (`@supports` property): this can lead to the refinement of subsequent attacks\n - detect when exactly the user opened the email (GET request timestamp)\n\n```html\n<div style=\"\n  width: 100vw;\n  height: 100vh;\n  background: if(\n    media((width > 500px)): red;\n    else: url('https://picsum.photos/200/300')\n  ); !important\"\n />\n   <h1>test</h1>   \n </div>\n```\n\nThis code force the browser to conditionally execute a GET request depending on the attacker-controlled width size. The `<h1>` tag is recommended (email can be otherwise automatically blocked by filters if no content is detected)",
			"styleAttributes":{"border":"invisible"},
			"x":40,
			"y":-1130,
			"width":1000,
			"height":920
		},
		{"id":"f20082777338f437","type":"file","file":"image.png","x":-1440,"y":-280,"width":900,"height":593},
		{
			"id":"b9a895354f0970c7",
			"type":"text",
			"text":"### Problem\n\n### There are A LOT of CSS properties and we should examine them in COMBINATION. How to deal with combinatorial explosion?",
			"styleAttributes":{"border":"invisible"},
			"x":-1100,
			"y":1370,
			"width":500,
			"height":280,
			"color":"3"
		},
		{
			"id":"e0b09f688e0a0d1f",
			"type":"text",
			"text":"### Extract ==core part of a data exfiltration attack== and identify properties that ==may be used for each phase==of the attack(s)\n\n## What attacks should we consider?\n### data exfiltration, history sniffing, browser fingerprinting, ...",
			"styleAttributes":{"border":"invisible"},
			"x":-540,
			"y":1370,
			"width":535,
			"height":280
		},
		{
			"id":"17c3a284da648c08",
			"type":"text",
			"text":"## There are inconsistency in the way the set of legal CSS properties is limited. \n## This affects: email providers, other platform that may allow user to insert CSS, app vulnerable to XSS that do not correctly sanitize CSS, or input sanification libraries, ...\n\n## On top of that, new properties are added every year, creating new attack scenarios. ==Adding new properties should take into consideration security risks==\n\n## Outcome: reference about the risks associated to CSS properties",
			"styleAttributes":{"border":"invisible"},
			"x":-1115,
			"y":660,
			"width":1030,
			"height":380
		},
		{
			"id":"91bb6c589921b113",
			"type":"text",
			"text":"# **RQ - What are the security implication of (latest) CSS properties?**",
			"styleAttributes":{"border":"invisible"},
			"x":24,
			"y":640,
			"width":565,
			"height":160
		},
		{
			"id":"1816faa48d3273ba",
			"type":"text",
			"text":"# **RQ - Do latest CSS properties carry security risks?**",
			"styleAttributes":{"border":"invisible"},
			"x":24,
			"y":850,
			"width":536,
			"height":140
		},
		{
			"id":"6bc48aeb13d19a9c",
			"type":"text",
			"text":"https://codepen.io/nicol-cavalli/pen/RNaYWKw",
			"styleAttributes":{"border":"invisible","textAlign":"center"},
			"x":2120,
			"y":90,
			"width":480,
			"height":60
		}
	],
	"edges":[
		{
			"id":"8d961c2fed7f958a",
			"styleAttributes":{},
			"toFloating":false,
			"fromNode":"cb1ce33dd947aa82",
			"fromSide":"right",
			"toNode":"e417f8785a49f988",
			"toSide":"bottom"
		},
		{
			"id":"89d34f14be564eea",
			"styleAttributes":{},
			"toFloating":false,
			"fromNode":"b9a895354f0970c7",
			"fromSide":"right",
			"toNode":"e0b09f688e0a0d1f",
			"toSide":"left"
		},
		{
			"id":"36af34afad5cdd04",
			"styleAttributes":{},
			"toFloating":false,
			"fromNode":"17c3a284da648c08",
			"fromSide":"right",
			"toNode":"91bb6c589921b113",
			"toSide":"left"
		},
		{
			"id":"25e701ee2378aedb",
			"styleAttributes":{},
			"toFloating":false,
			"fromNode":"17c3a284da648c08",
			"fromSide":"right",
			"toNode":"1816faa48d3273ba",
			"toSide":"left"
		}
	],
	"metadata":{
		"version":"1.0-1.0",
		"frontmatter":{}
	}
}