{
	"nodes":[
		{
			"id":"ecea64c839f4b57a",
			"type":"text",
			"text":"| Provider     | Effective | Description                               | Email                           \n| -----------  | --------- | -----------                               | -----                           \n| Gmail        |  ✅       | access to CSS var `--gm3-sys-color-error` | nicolo.cavalli95@gmail.com      \n| Proton       |  ✅       | access to CSS var `--signal-success`      | n.cavalli1618@proton.me         \n| Yahoo        |  ❌       | CSS var defined, `--var()` is forbidden   | ncavalli95@yahoo.com            \n| Outlook     |  ❌       | CSS var defined, `--var()` is forbidden   | ncavalli@outlook.it             \n| Apple        |              |                                                                   |          \n",
			"styleAttributes":{"textAlign":"center","border":"invisible"},
			"x":-560,
			"y":-80,
			"width":840,
			"height":240
		},
		{
			"id":"660ea28823c91c90",
			"type":"text",
			"text":"## Abusing `--var()` API to detect user device and track mail opening\n\nThis will use a local CSS variable in the web viewer, and will display the picture in the mobile version. An attacker can infer\n - if the user opened the email via the Gmail mobile application\n - when exactly the user opened the email (GET request timestamp)\n\n```html\n<div style=\"\n  width: 200px;\n  height: 300px;\n  background: var(--gm3-sys-color-error, url('https://picsum.photos/200/300'))\"\n/>\n```",
			"styleAttributes":{"border":"invisible"},
			"x":-580,
			"y":-500,
			"width":880,
			"height":420
		},
		{
			"id":"025c8d48f0a296c7",
			"type":"text",
			"text":"## Abuse `if()` API to detect user screen size\n\nThe new `if()` property allows us to style DOM elements based on conditions. Critically, this property can be defined in inline-style, and can still access sensitive media queries such as `@media`, `@orientation`, `@supports`, etc. \n\nAn attacker can abuse this new api to:\n - get approximate viewport size of the device\n - get aspect ratio\n - get its orientation (portrait/landscape)\n - ...\n - detect when exactly the user opened the email (GET request timestamp)\n\n```html\n<div style=\"\n  width: 100vw;\n  height: 100vh;\n  background: if(\n    media((width > 500px)): red;\n    else: url('https://picsum.photos/200/300')\n  ); !important\"\n />\n   <h1>test</h1>   \n </div>\n```\n\nThis code force the browser to conditionally execute a GET request depending on the attacker-controlled width size. The `<h1>` tag is recommended (email can be otherwise automatically blocked by filters if no content is detected)",
			"styleAttributes":{"border":"invisible"},
			"x":560,
			"y":-980,
			"width":900,
			"height":860
		},
		{
			"id":"ba0313b5ad564f5f",
			"type":"text",
			"text":"| Provider     | Effective | Description                              | Email                           \n| -----------  | --------- | -----------                                 | -----                           \n| Gmail        |  ❌       | `if()` is forbidden                     | nicolo.cavalli95@gmail.com      \n| Proton       |  ✅       | textual content is mandatory    | n.cavalli1618@proton.me         \n| Yahoo        |  ❌       | `if()` is forbidden                    | ncavalli95@yahoo.com            \n| Outlook     |             |                                                    | ncavalli@outlook.it             \n| Apple        |              |                                                    |          \n",
			"styleAttributes":{"textAlign":"center","border":"invisible"},
			"x":560,
			"y":-80,
			"width":840,
			"height":240
		}
	],
	"edges":[],
	"metadata":{
		"version":"1.0-1.0",
		"frontmatter":{}
	}
}